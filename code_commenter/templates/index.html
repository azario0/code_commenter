<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Code Commenter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>AI Code Commenter âœ¨</h1>
            <p>Paste your code or upload a file to get it professionally commented by AI.</p>
        </header>

        {% if error %}
            <div class="error-box">
                <p><strong>Error:</strong> {{ error }}</p>
            </div>
        {% endif %}

        <main>
            <form method="POST" enctype="multipart/form-data" id="code-form">
                <div class="form-group">
                    <label for="code_input">Paste your code here:</label>
                    <textarea name="code_input" id="code_input" rows="15" placeholder="e.g., def hello():&#10;    print('Hello, World!')">{{ original_code or '' }}</textarea>
                </div>

                <div class="form-group">
                    <label for="code_file">Or upload a file:</label>
                    <input type="file" name="code_file" id="code_file">
                </div>

                <button type="submit" id="submit-btn">
                    <span class="btn-text">Add Comments</span>
                    <span class="loader" style="display: none;"></span>
                </button>
            </form>

            {% if commented_code %}
            <section class="results">
                <h2>Results</h2>
                <div class="code-comparison">
                    <div class="code-box">
                        <h3>Original Code</h3>
                        <pre><code class="language-{{ extension }}">{{ original_code }}</code></pre>
                    </div>
                    <div class="code-box">
                        <h3>Commented Code
                            <a href="{{ url_for('download_file') }}" class="download-btn" download>Download</a>
                        </h3>
                        <pre><code class="language-{{ extension }}">{{ commented_code }}</code></pre>
                    </div>
                </div>
            </section>
            {% endif %}
        </main>

        <footer>
            <p>Powered by Flask & Google Gemini</p>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Simple script to show a loading spinner on form submission
        document.getElementById('code-form').addEventListener('submit', function() {
            const btn = document.getElementById('submit-btn');
            btn.disabled = true;
            btn.querySelector('.btn-text').style.display = 'none';
            btn.querySelector('.loader').style.display = 'inline-block';
        });
    </script>
</body>
</html>